<h2 style="color:#e46450; margin-bottom:1rem;">Einstellungen</h2>

<div style="display:grid;grid-template-columns:2fr 1fr;gap:1.5rem;flex-wrap:wrap;">

  <!-- Linke Spalte -->
  <div>
    <!-- Persönliche Daten -->
    <div style="background:#fff;padding:1.5rem;border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,0.1);margin-bottom:1.5rem;">
      <h3 style="margin-top:0;color:#002D55;">Persönliche Daten</h3>
      <form id="profileForm" style="display:grid;gap:1rem;">

        <div>
          <label><strong>E-Mail Adresse</strong></label>
          <input type="email" id="email" readonly 
            style="width:100%;padding:0.7rem;border:1px solid #ccc;border-radius:8px;background:#f7f7f7;">
          <small>Die E-Mail-Adresse kann nicht geändert werden</small>
        </div>

        <div>
          <label><strong>Name</strong></label>
          <input type="text" id="name"
            style="width:100%;padding:0.7rem;border:1px solid #ccc;border-radius:8px;">
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;">
          <div>
            <label><strong>Mobiltelefon</strong></label>
            <input type="tel" id="mobile" placeholder="+49 123 456789"
              style="width:100%;padding:0.7rem;border:1px solid #ccc;border-radius:8px;">
          </div>
          <div>
            <label><strong>Telefonnummer</strong></label>
            <input type="tel" id="phone" placeholder="+49 123 456789"
              style="width:100%;padding:0.7rem;border:1px solid #ccc;border-radius:8px;">
          </div>
        </div>

        <div>
          <label><strong>Rolle</strong></label>
          <input type="text" id="role" value="Teilnehmer" readonly 
            style="width:100%;padding:0.7rem;border:1px solid #ccc;border-radius:8px;background:#f7f7f7;">
          <small>Die Rolle wird vom Administrator vergeben</small>
        </div>

        <div style="display:flex;gap:1rem;">
          <button type="button" id="backBtn" style="padding:0.6rem 1.2rem;border:none;border-radius:8px;background:#eee;cursor:pointer;">
            ← Zurück
          </button>
          <button type="submit" style="padding:0.6rem 1.2rem;border:none;border-radius:8px;background:#002D55;color:white;cursor:pointer;">
            💾 Speichern
          </button>
        </div>
        <div id="profileMsg" style="margin-top:0.5rem;display:none;"></div>
      </form>
    </div>

    <!-- Weitere Einstellungen -->
    <div style="background:#fff;padding:1.5rem;border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,0.1);">
      <h3 style="margin-top:0;color:#002D55;">Weitere Einstellungen</h3>
      <ul style="list-style:none;padding:0;margin:0;">
        <li style="padding:0.8rem 0;border-bottom:1px solid #eee;cursor:pointer;">🔔 Benachrichtigungseinstellungen</li>
        <li style="padding:0.8rem 0;cursor:pointer;">🔑 Passwort ändern</li>
      </ul>
    </div>
  </div>

  <!-- Rechte Spalte -->
  <div style="display:flex;flex-direction:column;gap:1.5rem;">
    <!-- Erscheinungsbild -->
    <div style="background:#fff;padding:1.5rem;border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,0.1);">
      <h3 style="margin-top:0;color:#002D55;">Erscheinungsbild</h3>
      <p>Aktuelles Theme: <strong>Klassisches Design</strong></p>
      <button style="padding:0.6rem 1.2rem;border:none;border-radius:8px;background:#e46450;color:white;cursor:pointer;">
        🎨 Zu modernem Design wechseln
      </button>
    </div>

    <!-- Sicherheit -->
    <div style="background:#fff;padding:1.5rem;border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,0.1);">
      <h3 style="margin-top:0;color:#002D55;">Sicherheit</h3>
      <p>Zwei-Faktor-Authentifizierung (2FA)</p>
      <p style="font-size:0.9rem;color:#555;">Schützen Sie Ihr Konto mit einer zusätzlichen Sicherheitsebene.</p>
      <button style="padding:0.6rem 1.2rem;border:none;border-radius:8px;background:#002D55;color:white;cursor:pointer;">
        🔒 2FA aktivieren
      </button>
    </div>
  </div>
</div>

<script type="module">
  import { auth } from "../js/firebase.js";
  import { updateProfile } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-auth.js";

  const user = auth.currentUser;
  const emailField = document.getElementById("email");
  const nameField = document.getElementById("name");
  const mobileField = document.getElementById("mobile");
  const phoneField = document.getElementById("phone");
  const profileForm = document.getElementById("profileForm");
  const profileMsg = document.getElementById("profileMsg");
  const backBtn = document.getElementById("backBtn");

  // Felder initial befüllen
  if (user) {
    emailField.value = user.email || "";
    nameField.value = user.displayName || "";
    // 📌 Telefonnummern könnten später aus Firestore kommen
  }

  // Speichern
  profileForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    try {
      if (user) {
        await updateProfile(user, { displayName: nameField.value });
        // Telefonnummern hier später mit Firestore speichern
        profileMsg.style.display = "block";
        profileMsg.style.color = "green";
        profileMsg.textContent = "✅ Änderungen gespeichert!";
      }
    } catch (err) {
      profileMsg.style.display = "block";
      profileMsg.style.color = "red";
      profileMsg.textContent = "❌ Fehler: " + err.message;
    }
  });

  // Zurück Button → Dashboard
  backBtn.addEventListener("click", () => {
    window.location.hash = "#dashboard";
  });
</script>

  });
</script>
